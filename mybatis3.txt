配置文件可以放在项目文件下的最高级别(与src目录同级)
模板
    mybatis的代码
        接口层/API层
            接口(mapper.java)
                insert-增
                    @Param
                delete-删
                    @Param
                update-改
                    @Param
                select-查
                    @Param
                    @MapKey
                参数传递
                    单个参数
                    多个参数
                    命名参数
                    POJO
                    Map
                    参数的传递原理(源代码)
            数据查询接口
        数据处理层
        基础支持层
            缓存
                一级缓存
                    一级缓存的失效情况
                        1.SqlSession不同
                        2.SqlSession相同,但是查询条件不同(当前一级缓存中还没有这个数据)
                        3.SqlSession相同,但两次查询之间执行了增删改操作
                        4.SqlSession相同,但手动清除了一级缓存(调用clearCache方法)
                二级缓存
                    二级缓存的工作机制
                        1、一个会话，查询一条数据，这个数据就会被放在当前会话的一级缓存中；
                        2、如果会话关闭；一级缓存中的数据会被保存到二级缓存中；新的会话查询信息，就可以参照二级缓存中的内容；
                        3.不同namespace查出的数据会放在自己对应的缓存中（map）
                        效果:数据会从二级缓存中获取,查出的数据都会被默认先放在一级缓存中。只有会话提交或者关闭以后，一级缓存中的数据才会转移到二级缓存中
                    二级缓存的使用
                缓存有关的设置以及属性
                    具体内容
                    cacheEnabled
                    useCache
                    flushCache
                    sqlSession.clearCache()
                    localCacheScope
                缓存的使用顺序
                    如果二级缓存开启的话,先检查二级缓存,在检查一级缓存,最后都没有,再去数据库中查询数据
                cache
                cache-ref
            连接管理
            事务管理
    mybatis的使用
        使用myabtis的三种方式
            基于StatementId的方式去执行sql
                使用基本流程(不与spring配合的情况下)
                    Resource类
                    SqlSessionFactoryBuilder
                    SqlSessionFactory
                    SqlSession
                        使用方式
                            旧用法(selectOne)
                            新用法(接口式编程)
            基于接口绑定的方式去执行
            基于注解的方式去执行
        居于接口绑定的方式：
            配置文件
            mybatis-config.xml
                properties
                    resource:引入类路径下的资源
                    url:引入网络路径或者磁盘路径下的资源
                settings
                    cacheEnabled
                    lazyLoadingEnabled
                    aggressiveLazyLoading
                    multipleResultSetsEnabled
                    useColumnLabel
                    useGeneratedKeys
                    autoMappingBehavior
                    autoMappingUnknownColumnBehavior
                    defaultExecutorType
                    defaultStatementTimeout
                    defaultFetchSize
                    safeRowBoundsEnabled
                    safeResultHandlerEnabled
                    mapUnderscoreToCamelCase
                    localCacheScope
                    jdbcTypeForNull
                    lazyLoadTriggerMethods
                    defaultScriptingLanguage
                    defaultEnumTypeHandler
                    callSettersOnNulls
                    returnInstanceForEmptyRow
                    logPrefix
                    logImpl
                    proxyFactory
                    vfsImpl
                    useActualParamName
                    configurationFactory
                typeAliases
                    package
                        name:为一个包包括其子包的所有类起一个默认的别名(类名小写)
                    typeAlias
                        type:指定全类名
                        alias:指定别名,不指定的话会有默认的别名,就是全类名中的类名小写
                    @Alias注解
                typeHandlers
                objectFactory
                plugins
                environments
                    transactionManager
                    dataSource
                databaseIdProvider
                mappers
                    mapper
                        resource
                        url
                        class
                    package
                    mybatis也可以不写xml文件,而直接在接口文件上以注解的方式注册sql
                MyBatis配置文件详解
                    1.properties 属性
                        连接数据库的配置单独放在一个properties文件中
                    2.settings全局的参数配置
                        这是 MyBatis 中极为重要的调整设置，它们会改变 MyBatis 的运行时行为。
                    3.typeAliases(别名)
                        为实体类定义别名，简化sql映射xml文件中的引用
                        1.单个别名的定义
                        2.批量定义别名(常用)
                    4.mappers(映射配置)
                        1.通过resource加载单个映射文件
                        2.通过mapper接口加载单个mapper
                        3.批量加载mapper（推荐使用）
            mapper.xml使用mybatis
                resultMap定义返回map
                    resaultMap标签内部属性
                        type
                        id
                    下属标签
                        id
                            标签内部属性
                                column
                                property
                        resault
                            column
                            property
                        association对象类型属性
                            内部属性
                                property
                                javaType
                                select
                                column
                                fenthType
                                    lazy
                                        使用延迟加载
                                    eager
                                        立即加载
                            内部标签
                                id
                                resault
                            使用association进行分步查询
                                分步查询的好处
                                    1.组合已有的方法完成功能
                                    2.可以使用延迟加载
                                        使用时需要在setting中添加配置
                                            lazyLoadingEnable>>true
                                            aggressiveLazyLoading>>false
                                        在配置完成后,被分步查询的实体类中的对象类型只有在被使用时才会去查询并加载
                        collection 集合封装
                            内部属性
                                property
                                ofType
                                fenthType
                                    lazy
                                        使用延迟加载
                                    eager
                                        立即加载
                            内部标签
                                id
                                resault
                            使用collection进行分步查询
                                延迟加载的用法和association中一样
                        association和collection中的column属性传递多个值
                        discriminator
                            内部属性
                                javaType
                                column
                            case
                                内部属性
                                    value
                                    resultType
                    typeAlias类别名
                    高级结果映射
                    关联查询
                        association一对一关联
                            方式一：嵌套结果：使用嵌套结果映射来处理重复的联合结果的子集
                            方式二：嵌套查询：通过执行另外一个SQL映射语句来返回预期的复杂类型
                        association映射多对一
                                property:对象属性的名称
                                javaType:对象属性的类型
                                column:所对应的外键字段名称
                                select:使用另一个查询封装的结果
                            根据贴子id读取一个贴子，然后读取贴子所属的用户信息
                        collection映射一对多
                            方式一: 嵌套结果: 使用嵌套结果映射来处理重复的联合结果的子集
                             方式二：嵌套查询：通过执行另外一个SQL映射语句来返回预期的复杂类型
                        多对多关联
                 增删改查
                    insert
                        在插入过程中获取自增主键的值
                            MySQL
                            Oracle
                        selectKey
                            keyProperty
                            resaultType
                            order
                    delete
                    update
                    select
                        resultType
                        resultMap被使用的上面定义的
                        id
                        select返回List集合
                        select返回Map
                        select返回特殊map,Map的value是实体类,key是实体类中的一个属性
                        嵌套查询
                        延迟查询
                    9种动态SQL
                        语句拼接
                            where 标签
                            trim拼接
                                标签属性
                                    prefix
                                    prefixOverrides
                                    suffix
                                    suffixOverrides
                            set 动态更新
                        逻辑
                            choose when otherwise类似switch
                                下属标签
                                    when
                                    otherwise
                            if可选表达式功能
                                test
                                    多数据库支持
                            foreach
                                标签属性
                                    collection
                                        1.单参数List的类型：
                                        2.单参数array数组的类型
                                        3.自己把参数封装成Map的类型
                                        1、foreach标签遍历的集合元素类型是Map.Entry类型时
                                        数据类型
                                    item
                                    separator
                                    open
                                    close拼接后字符串
                                    index
                                mysql下批量插入数据
                                    利用一条插入语句同时插入多条数据
                                    发送多条sql语句进行插入,需要"allowMultiQueries=true"的支持
                                Oracle下批量插入数据
                                    oracle数据库的两种遍历方式
                                    1、多个insert放在begin - end里面
                                        mapper.xml文件示例
                                    2、利用中间表
                                        mapper.xml文件示例
                                MySQL下批量保存和Oracle下不一样
                        sql准备
                        bind变量准备
                            _parameter
                            _databaseId
                            即使不使用动态sql,只要在xml文件中,这两个参数都是可以使用的
                        include引用
                        sql用来抽取,include用来引用,include还可以自定义一些property属性,sql也可以引用这些属性
                        原理
                            OGNL表达式
                    parameterType
                        参数获取
                            ${}与#{}中可以使用的标签
                                javaType
                                jdbcType
                                mode
                                numericScale
                                resultMap
                                typeHandler
                                jdbcTypeName
                        参数处理
                            1、单个参数
                            Mybatis传多个参数
                                多参数与数组？
                                    其中，#{0}代表接收的是dao层中的第一个参数，#{1}代表dao层中第二参数，更多参数一致往后加即可。
                                多参数与map封装
                                多参数与list封装in
                                多参数传递之注解方式示：    
                                @Param一致性问题
                                    spring中@param
                                        dao接口
                                               /** 
                                                *查询指定用户和企业关联有没有配置角色
                                                * @param businessId  memberId
                                                * @return
                                                */
                                                int selectRoleCount(@Param(&amp;quot;businessId&amp;quot;) Integer businessId,@Param(&amp;quot;memberId&amp;quot;) Long memberId); 
                                                                                    在xml文件中使用
                                                                                        &amp;lt;select id=&amp;quot;selectRoleCount&amp;quot; resultType=&amp;quot;java.lang.Integer&amp;quot; &amp;gt;
                                            select     count(tbm.id)    from t_business_member_relation tbm
                                                where tbm.business_id = #{0,jdbcType=INTEGER}
                                                and tbm.member_id = #{1,jdbcType=INTEGER}
                                                and tbm.role_business_id is not null
                                            &amp;lt;/select&amp;gt;
                                    mybatis中的param
                                        dao接口
                                             /**
                                                * 查询指定用户和企业关联有没有配置角色
                                                * @param businessId memberId
                                                * @return
                                                */
                                                int selectRoleCount(@Param(&amp;quot;businessId&amp;quot;) Integer businessId,@Param(&amp;quot;memberId&amp;quot;) Long memberId); 
                                                                                    在xml文件中使用
                                                                                        &amp;lt;select id=&amp;quot;selectRoleCount&amp;quot; resultType=&amp;quot;java.lang.Integer&amp;quot; &amp;gt;
                                                select     count(tbm.id)    from t_business_member_relation tbm
                                                where tbm.business_id = #{businessId,jdbcType=INTEGER}
                                                and tbm.member_id = #{memberId,jdbcType=INTEGER}
                                                and tbm.role_business_id is not null
                                            &amp;lt;/select&amp;gt;
                                    混用会抛出参数绑定异常
                                        org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.binding.BindingException: Parameter &amp;apos;businessId&amp;apos; not found. Available parameters are [1, 0, param1, param2]
                            3、参数类型
                                POJO
                                Map
                                TO
                            4、其他特殊场景
                            5、源码分析参数处理
                            6、参数值的获取
                oralce中插入null的处理
        批量插入
            循环逐条插入foreach的方式
            batch的方式不常用
            直接执行多个sql语句
        MyBatis查询缓存
            说明
                mybaits提供一级缓存，和二级缓存。
                缓存的区别
            一级缓存（sqlsession相同）
                工作原理
                使用场景
            二级缓存(nameplace相同)
                工作原理
                开启二级缓存
                禁用二级缓存　
                刷新缓存
                    在mapper的同一个namespace中，如果有其它insert、update、delete操作数据后需要刷新缓存，如果不执行刷新缓存会出现脏读。
                    设置statement配置中的flushCache=&amp;quot;true&amp;quot; 属性，默认情况下为true即刷新缓存，如果改成false则不会刷新。使用缓存时如果手动修改数据库表中的查询数据会出现脏读。
                    &amp;lt;insert id=&amp;quot;insertUser&amp;quot; parameterType=&amp;quot;com.mybaits.entity.User&amp;quot; flushCache=&amp;quot;true&amp;quot;&amp;gt;
                Mybatis Cache参数
                    lushInterval（刷新间隔）
                        可以被设置为任意的正整数，而且它们代表一个合理的毫秒形式的时间段。默认情况是不设置，也就是没有刷新间隔，缓存仅仅调用语句时刷新。
                    size（引用数目）
                        可以被设置为任意正整数，要记住你缓存的对象数目和你运行环境的可用内存资源数目。默认值是1024。
                    readOnly（只读）
                        可以被设置为true或false。只读的缓存会给所有调用者返回缓存对象的相同实例。因此这些对象不能被修改。这提供了很重要的性能优势。可读写的缓存会返回缓存对象的拷贝（通过序列化）。这会慢一些，但是安全，因此默认是false。 
                    eviction(收回策略)
                            LRU – 最近最少使用的:移除最长时间不被使用的对象。
                            FIFO – 先进先出:按对象进入缓存的顺序来移除它们。
                            SOFT – 软引用:移除基于垃圾回收器状态和软引用规则的对象。
                            WEAK – 弱引用:更积极地移除基于垃圾收集器状态和弱引用规则的对象。
                    示例
                二级缓存应用场景
                    对于访问多的查询请求且用户对查询结果实时性要求不高，此时可采用mybatis二级缓存技术降低数据库访问量，提高访问速度，
                    业务场景比如：耗时较高的统计分析sql、电话账单查询sql等。
                二级缓存的局限性
                    mybatis二级缓存对细粒度的数据级别的缓存实现不好
        MyBatis延迟加载
            使用association实现延迟加载
                使用association中的select指定延迟加载去执行的statement的id。
            在mybatis核心配置文件中的配置
                mybatis默认没有开启延迟加载，需要在SqlMapConfig.xml中setting配置。
        打印sql执行语句
            添加log4j.properties
            配置sql打印
    整合相关
        SSM整合01
        第三方缓存整合
            mybatis整合ehcache
                需要导入ehcache的jar包,具体使用请看视频
        集成日志框架
    高级使用
        mybatis逆向工程
            使用步骤
                创建mgb.xml(名称任意)配置文件
                    配置文件示例
                        配置文件可以放在项目文件下的最高级别(与src目录同级)
                执行代码
            mybatis-plus-codegenerate
                组成
                    代码内容
                        main
                            全局配置
                            数据源配置
                            包配置
                            自定义配置
                            // 自定义输出配置
                            // 配置模板
                            // 策略配置
                            // 公共父类
                            // 写于父类中的公共字段
                    需要改的内容
                        项目的名称
                使用
                    自定义模板引擎
                    自定义代码模板
                    自定义属性注入
                    字段其他信息查询注入
        mybatis的插件
            mybatis插件开发
                四大对象
                    executor
                    parameterhandler
                    resultsethandler
                    statementhandler
                Interceptor接口
                    接口中的方法
                        intercept
                            拦截目标对象方法的执行
                        plugin
                            包装目标对象
                            所谓包装,指为目标对象创建一个代理对象
                        setProperties
                            将插件注册时的properties设置进来
                具体步骤
                    1.创建一个类,继承Interceptor接口
                    2.重写其中的方法
                    3.添加注解 @Intercepts
                        写法示例
                    4.将插件注册到全局配置文件中
                插件包装和执行的顺序
                    按照在全局配置文件中的配置顺序进行包装,先包装的插件的方法后执行
            mybatis分页插件pagehelper
                官方文档地址
                    https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md
                分页插件、代码生成器
                分页插件的使用
                分页插件原理
            mybatis插件运行原理及开发流程
                MySQL下批量保存和Oracle下不一样
                即使不使用动态sql,只要在xml文件中,这两个参数都是可以使用的
                sql用来抽取,include用来引用,include还可以自定义一些property属性,sql也可以引用这些属性