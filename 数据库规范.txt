数据库 -  规范
    库
        库名与应用名称尽量一致
        全局
            表达是与否概念的字段，必须使用 is_xxx 的方式命名
            禁用保留字，如 desc、range、match、delayed 等
    数据库设计
        4. 数据库设计时，应该要对以后扩展进行考虑
    数据库创建表
        1、创建表的时候必须指定主键，并且主键建立后最好不要再有数据修改的需求
            修改会导致聚簇索引性能下降
        2、创建表选择字段的时候，在符合业务需求的情况下尽量小，数据类型尽量简单
        3、创建表的时候显式申明存储引擎
        4、创建表的时候显式申明字符集
        5、创建表的时候对经常要查询的列添加索引或者组合索引
        6、创建表的时候对字段和表添加COMMENT
        7、创建表的时候不要添加drop操作
        8、创建表的时候，字段尽量不要为
    (一) 建表规约	27
        表名字
            表名、字段名必须使用小写字母或数字
            表的命名最好是加上“业务名称_表的作用”。
            并用下划线分割
            临时库表必须以 tmp
            备份表必须以 bak 为前缀并以日期 (时间戳) 为后缀
            所有存储相同数据的列名和列类型必须一致
            禁止
                所有数据库对象名称禁止使用 MySQL 保留关键字
                表名不使用复数名词
                禁止出现数字开头，禁止两个下划线中间只 出现数字
                数据库对象的命名要能做到见名识意，并且最后不要超过 32 个字符
        表内容
            减小表的宽度
            禁止在数据库中存储图片,文件等大的二进制数据
        字段
            表必备三字段：id, gmt_create, gmt_modified。
            主键
                主键名字
                    主键索引名为 pk_字段名；
                    唯一索引名为 uk_字段名
                    普通索引名则为 idx_字段名
                不使用uuid主键
                使用和业务没有关系的自增id
            1.2 数据库字段注意点
                1.2.1 字段是否会超长
                1.2.2 字段为空，是否会导致空指针等
                1.2.3 字段缺失
                1.2.4 字段类型是否支持表情
                1.2.5 谨慎使用text、blob字段
                禁止在表中建立预留字段
                1.6 新老数据兼容
                    1.6.1 新加的字段，考虑存量数据的默认值
                    1.6.2 如果新业务用老的字段，考虑老数据的值是否有坑
            冗余字段
                必须考虑数据一致性
                2）不是 varchar 超长字段，更不能是 text 字段。
                1）不是频繁修改的字段。
            字段类型
                数据长度的限制
                    优先选择符合存储需要的最小的数据类型
                    如果存储的字符串长度几乎相等，使用 char 定长字符串类型。
                    varchar 是可变长字符串，不预先分配存储空间，长度不要超过 5000，
                    text 存储长度大于5000
                    合适的字符存储长度
                字符串转数字
                    如:将 IP 地址转换成整形数据
                        inet_aton 把 ip 转为无符号整型 (4-8 位)
                        inet_ntoa 把整型的 ip 转为地址
                无符号整形
                    b.对于非负型的数据 (如自增 ID,整型 IP) 来说,要优先使用无符号整型来存储
                时间
                    使用 TIMESTAMP(4 个字节) 或 DATETIME 类型 (8 个字节) 存储时间
                        TIMESTAMP 存储的时间范围 1970-01-01 00:00:01 ~ 2038-01-19-03:14:07
                        TIMESTAMP 占用 4 字节和 INT 相同，但比 INT 可读性高
                        超出 TIMESTAMP 取值范围的使用 DATETIME 类型存储
                        经常会有人用字符串存储日期型的数据（不正确的做法）
                        缺点 1：无法用日期函数进行计算和比较
                        缺点 2：用字符串存储日期要占用更多的空间
                金额类型
                    同财务相关的金额类数据必须使用 decimal 类型
                        非精准浮点：float,double
                        精准浮点：decimal
                        Decimal 类型为精准浮点数，在计算时不会丢失精度
                        占用空间由定义的宽度决定，每 4 个字节可以存储 9 位数字，并且小数点要占用一个字节
                        可用于存储比 bigint 更大的整型数据
                禁止
                    避免使用 TEXT,BLOB 数据类型
                        建议把 BLOB 或是 TEXT 列分离到单独的扩展表中
                        TEXT 或 BLOB 类型只能使用前缀索引
                    3避免使用 ENUM 类型
                        修改 ENUM 值需要使用 ALTER 语句
                        ENUM 类型的 ORDER BY 操作效率低，需要额外操作
                        禁止使用数值作为 ENUM 的枚举值
        注解
            即时更新注解
            必须添加注释
        参数选择
            1. 所有表必须使用 Innodb 存储引擎
            2. 数据库和表的字符集统一使用 UTF8
        数据库三范式
            3. 每个 Innodb 表必须有个主键
                Innodb 是一种索引组织表：数据的存储的逻辑顺序和索引的顺序是相同的。每个表都可以有多个索引，但是表的存储顺序只能有一种。
                Innodb 是按照主键索引的顺序来组织表的
                不要使用更新频繁的列作为主键，不适用多列主键（相当于联合索引）
                不要使用 UUID,MD5,HASH,字符串列作为主键（无法保证数据的顺序增长）
                主键建议使用自增 ID 值
    表的使用
        分库分表
            单表行数超过 500 万行或者单表容量超过 2GB，才推荐进行分库分表
            谨慎使用 MySQL 分区表
        2. 对于大表使用 pt-online-schema-change 修改表结构
            避免大表修改产生的主从延迟
            避免在对表字段进行修改时进行锁表
            对大表数据结构的修改一定要谨慎，会造成严重的锁表操作，尤其是生产环境，是不能容忍的。
            pt-online-schema-change 它会首先建立一个与原表结构相同的新表，并且在新表上进行表结构的修改，然后再把原表中的数据复制到新表中，并在原表中增加一些触发器。把原表中新增的数据也复制到新表中，在行所有数据复制完成之后，把新表命名成原表，并把原来的表删除掉。把原来一个 DDL 操作，分解成多个小的批次进行。
        1. 超 100 万行的批量写 (UPDATE,DELETE,INSERT) 操作,要分批多次进行操作
            大批量操作可能会造成严重的主从延迟
            主从环境中,大批量操作可能会造成严重的主从延迟，大批量的写操作一般都需要执行一定长的时间， 而只有当主库上执行完成后，才会在其他从库上执行，所以会造成主库与从库长时间的延迟情况
            binlog 日志为 row 格式时会产生大量的日志
            大批量写操作会产生大量日志，特别是对于 row 格式二进制数据而言，由于在 row 格式中会记录每一行数据的修改，我们一次修改的数据越多，产生的日志量也就会越多，日志的传输和恢复所需要的时间也就越长，这也是造成主从延迟的一个原因
            避免产生大事务操作
            大批量修改数据，一定是在一个事务中进行的，这就会造成表中大批量数据进行锁定，从而导致大量的阻塞，阻塞会对 MySQL 的性能产生非常大的影响。
            特别是长时间的阻塞会占满所有数据库的可用连接，这会使生产环境中的其他应用无法连接到数据库，因此一定要注意大批量写操作要进行分批