kubernetes 对象
    资源的概念
        namespace类型的资源
            负载分类
                Pod
                ReplicaSet
                Deployment
                statefulSet
                DaemonSet
                Job
                CronJob
            服务发现，负载均衡分类
                Service
                Ingress
            配置与存储资源
                configMap
                CSI
                Volume
                ResourceQuota
                    hard
                        资源占用限制
                            limits
                                cpu
                                memory
                                ephemeral-storage
                            requests
                                cpu
                                memory
                                storage
                                ephemeral-storage
                            hugepages-
                            cpu
                                同requests.cpu
                            memory
                                同requests.memory
                            ephemeral-storage
                        对象数量限制
                            configmaps
                            persistentvolumeclaims
                            pods
                            replicationcontrol
                            resourcequotas
                            services
                            services.loadbalancers
                            service.nodeports
                            secrets
                        这些限制都仅限于同一个namespace下
                    scopeSelector
                        提供比scopes更复杂和可自定义程度更高的匹配模式
                        matchExpression
                            operator
                                In
                                NotIn
                                Exists
                                DoesNotExist
                            scopeName
                                可定义的值与scopes属性相同，如果不是PriorityClass、CrossNamespacePodAffinity，那么operator必须是Exists
                            values
                                operator条件匹配的具体值，如果是In和NotIn就必须设置，且不可为空
                    scopes
                        限制此quota能够限制的资源的pod范围，并且仅追踪和限制pod的资源占用类的属性
                        枚举类型
                            Terminating
                                匹配.spec.activeDeadlineSeconds >= 0的pod
                            NotTerminating
                                匹配 .spec.activeDeadlineSeconds 未设置的pod
                            BastEffort
                            NotBestEffort
                            PriorityClass
                            CrossNamespacePodAffinity
                                功能还不成熟，且文档过于难理解暂时搁置
                            两者在相同quota中互斥
                            两者在相同quota中互斥
                    ResourceQuota是对namespace下整体资源的强制限制
            特殊分类
                Secret
                Downward API
        集群类型的资源
            Namespace
            Node
            Role
            RoleBinding
                通过已经定义的Role权限授予到用户、用户组
            ClusterRouter
            ClusterRoleBinding
        元数据类型资源
            HPA
            PodTemplate
            LimitRange
                限制一个namespace下每个类型的资源占用，相对与ResourceQuota的控制更精细
                在pod下的所有container都会遵循LimitRange
                limits
                    default
                    defaultRequest
                    max
                    min
                    maxLimitReuqestRatio
                        LimitRequestRatio = limit(required)/request(required)
                    type
                        pod
                        container
                        PersistentVolumeClaim
                    pod、container支持cpu、memory仅支持PersistentVolumeClaim仅支持storage
        具体还有一些资源没有列出来，可以直接通过K8S的命令行查看
            kubectl api-resources
    pod
        pod类型
            自主式pod
                生命周期有用户自行管理
            控制器管理的pod
                控制器的生命周期内，都会维持pod定义的副本数，保证pod的正常运行
        资源
            pod生命周期
                pod phase
                    Pending
                        有容器正在被初始化
                    Running
                        已被绑定到一个节点上，pod中所有容器已被创建，至少有一个容器正在运行
                    Succeeded
                        所有容器被成功终止，且不会在被重启
                    Failed
                        所有容器已终止，至少有一个容器以非0状态退出或被系统终止
                    Unknown
                        无法获取pod状态，通常是因为与 Pod 所在主机通信失败
                过程
                    initC
                        会首先初始化pause底层容器
                        运行直到成功完成为止
                        串行，如果失败，k8s会重启pod
                            如果restartPolicy为Never，不会被重启
                        pod就绪之前完成
                        在PodSpec添加initContainers清单添加initC
                        与普通容器的区别
                            1. 支持普通容器的所有资源特性
                            2. 必须在Pod就绪前运行完成，且之后会自行退出
                            3. 不支持Readiness Probe
                            4. initC具有访问Secret权限，而不同容器不行
                            5. initC只能串行，而普通容器可以并行
                        有什么用？
                            1. 包含并运行实用工具，出于安全考虑，不建议应用容器包含这些工具
                            2. 使用工具和定制化代码安装，但是不能出现在应用程序镜像中，不需要FROM另一个镜像
                            3. 可以分离创建和部署角色，没有必要联合它们构建一个单独的镜像
                            4. 相对应用程序容器来说具有不同的文件系统视图。比如，它们能够具有访问 Secret 的权限，而应用程序容器则不能
                            5. 它们必须在应用程序容器启动之前运行完成，而应用程序容器是并行运行的，所以 Init 容器能够提供了一种简单的阻塞或延迟应用容器的启动的方法，直到满足了一组先决条件
                    容器探针pod hook
                        Handler
                            ExecAction
                            TCPSocketAction
                            HTTPGetAction
                        诊断时机
                            START
                                启动命令
                            livenessprobe
                                不提供的话，默认为success状态
                                如果监测失败，kubelet会根据重启策略，决定是否重启pod
                                直到Pod退出
                                可执行对应的命令
                            readinessprobe
                                检查是否准备好
                                探测失败，端点控制器将从与 Pod 匹配的所有 Service 的端点中删除该 Pod 的 IP 地址
                                初始化完成之前，就绪状态默认为 Failure
                                不提供就绪探针，默认状态为success
                            STOP
                                结束命令
                    重启策略
            集群安全机制
            HELM
                类似Rancher
    资源配置
        yaml语法
        常用字段
            version
                K8S API版本
            kind
                资源类型和角色，如Pod
            metadata
                name
                    pod命名
                namespace
                    设置namespace
            spec
                container[]
                    name
                        容器名称
                    image
                        镜像名称
                    livenessProbe
                        自定义liveness检查
                    readnessProbe
                        自定义readness检查
                    imagePollPolicy
                        Always
                            总是拉取
                        Never
                            仅使用本地镜像
                        IfNotPresent
                            如果不存在就拉取
                    command[]
                        容器启动命令
                    args[]
                        容器启动命令参数
                    workingDir
                        工作目录
                    volumeMounts[]
                        name
                            被容器挂在的存储卷名称
                        mountPath
                            被挂载存储卷路径
                        readOnly
                            存储卷的读写限制，是否只读
                    ports[]
                        name
                            端口名称
                        containerPort
                            设置容器监听的端口号
                        hostPort
                            主机监听的端口号，默认与containerPort相同，如果指定，那么同一台主机无法创建此同期相同的副本
                        protocol
                            端口协议，TCP\UDP
                    evn[]
                        name
                            环境变量名称
                        value
                            环境变量值
                    resources
                        limits
                            cpu
                                cpu算力限制，单位核数
                            memory
                                内存限制，MB、GB
                        requests
                            cpu
                                初始化时的核数限制
                            memory
                                初始化时内存限制
                restartPolicy
                    Always
                        一旦停止，k8s都会重启这个pod
                    OnFailure
                        只有非0推出时，才会重启
                    Never
                        kubelet只报告给master，不会重启
                nodeSelector
                    定义Node的Label的过滤标签，key/value
                imagePullSecrets
                    定义pull镜像时使用secret名称，name:secretKey格式指定
                hostNetwork
                    是否使用主机网络模式，默认false
        kubectl explain pod
            可查看资源清单模板可使用的字段以及类型描述